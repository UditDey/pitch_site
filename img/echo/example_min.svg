<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 420" width="400" height="420">
  <style>
    .boundary { fill: none; stroke: #000; stroke-width: 1.2; }
    .switch { fill: none; stroke: #000; stroke-width: 1; }
    .line { fill: none; stroke: #000; stroke-width: 0.8; }
    .node { fill: #000; }
    .label { font-family: system-ui, -apple-system, sans-serif; font-size: 11px; fill: #000; }
    .shuffle-region { fill: none; stroke: #555; stroke-width: 1; stroke-dasharray: 6,3; }
    .title-label { font-family: system-ui, -apple-system, sans-serif; font-size: 24px; fill: #000; font-weight: bold; }
  </style>
  <rect class="boundary" x="40" y="40" width="320" height="310" rx="6"/>
  <g id="inputs">
    <circle class="node" cx="65" cy="40" r="4"/>
    <circle class="node" cx="95" cy="40" r="4"/>
    <circle class="node" cx="145" cy="40" r="4"/>
    <circle class="node" cx="175" cy="40" r="4"/>
    <circle class="node" cx="225" cy="40" r="4"/>
    <circle class="node" cx="255" cy="40" r="4"/>
    <circle class="node" cx="305" cy="40" r="4"/>
    <circle class="node" cx="335" cy="40" r="4"/>
  </g>
  <g id="input-wires" opacity="0.4">
    <path class="line" d="M65,44 L65,80"/>
    <path class="line" d="M95,44 L95,80"/>
    <path class="line" d="M145,44 L145,80"/>
    <path class="line" d="M175,44 L175,80"/>
    <path class="line" d="M225,44 L225,80"/>
    <path class="line" d="M255,44 L255,80"/>
    <path class="line" d="M305,44 L305,80"/>
    <path class="line" d="M335,44 L335,80"/>
  </g>
  <g id="stage1" opacity="0.4">
    <rect class="switch" x="50" y="80" width="60" height="40" rx="4"/>
    <rect class="switch" x="130" y="80" width="60" height="40" rx="4"/>
    <rect class="switch" x="210" y="80" width="60" height="40" rx="4"/>
    <rect class="switch" x="290" y="80" width="60" height="40" rx="4"/>
  </g>
  <g id="stage1-to-shuffle" opacity="0.4">
    <path class="line" d="M65,120 L65,135"/>
    <path class="line" d="M95,120 L95,135"/>
    <path class="line" d="M145,120 L145,135"/>
    <path class="line" d="M175,120 L175,135"/>
    <path class="line" d="M225,120 L225,135"/>
    <path class="line" d="M255,120 L255,135"/>
    <path class="line" d="M305,120 L305,135"/>
    <path class="line" d="M335,120 L335,135"/>
  </g>
  <rect class="shuffle-region" x="50" y="135" width="300" height="25" rx="4"/>
  <g id="shuffle-to-stage2" opacity="0.4">
    <path class="line" d="M65,160 L65,175"/>
    <path class="line" d="M95,160 L95,175"/>
    <path class="line" d="M145,160 L145,175"/>
    <path class="line" d="M175,160 L175,175"/>
    <path class="line" d="M225,160 L225,175"/>
    <path class="line" d="M255,160 L255,175"/>
    <path class="line" d="M305,160 L305,175"/>
    <path class="line" d="M335,160 L335,175"/>
  </g>
  <g id="stage2" opacity="0.4">
    <rect class="switch" x="50" y="175" width="60" height="40" rx="4"/>
    <rect class="switch" x="130" y="175" width="60" height="40" rx="4"/>
    <rect class="switch" x="210" y="175" width="60" height="40" rx="4"/>
    <rect class="switch" x="290" y="175" width="60" height="40" rx="4"/>
  </g>
  <g id="stage2-to-shuffle" opacity="0.4">
    <path class="line" d="M65,215 L65,230"/>
    <path class="line" d="M95,215 L95,230"/>
    <path class="line" d="M145,215 L145,230"/>
    <path class="line" d="M175,215 L175,230"/>
    <path class="line" d="M225,215 L225,230"/>
    <path class="line" d="M255,215 L255,230"/>
    <path class="line" d="M305,215 L305,230"/>
    <path class="line" d="M335,215 L335,230"/>
  </g>
  <rect class="shuffle-region" x="50" y="230" width="300" height="25" rx="4"/>
  <g id="shuffle-to-stage3" opacity="0.4">
    <path class="line" d="M65,255 L65,270"/>
    <path class="line" d="M95,255 L95,270"/>
    <path class="line" d="M145,255 L145,270"/>
    <path class="line" d="M175,255 L175,270"/>
    <path class="line" d="M225,255 L225,270"/>
    <path class="line" d="M255,255 L255,270"/>
    <path class="line" d="M305,255 L305,270"/>
    <path class="line" d="M335,255 L335,270"/>
  </g>
  <g id="stage3" opacity="0.4">
    <rect class="switch" x="50" y="270" width="60" height="40" rx="4"/>
    <rect class="switch" x="130" y="270" width="60" height="40" rx="4"/>
    <rect class="switch" x="210" y="270" width="60" height="40" rx="4"/>
    <rect class="switch" x="290" y="270" width="60" height="40" rx="4"/>
  </g>
  <g id="output-wires" opacity="0.4">
    <path class="line" d="M65,310 L65,346"/>
    <path class="line" d="M95,310 L95,346"/>
    <path class="line" d="M145,310 L145,346"/>
    <path class="line" d="M175,310 L175,346"/>
    <path class="line" d="M225,310 L225,346"/>
    <path class="line" d="M255,310 L255,346"/>
    <path class="line" d="M305,310 L305,346"/>
    <path class="line" d="M335,310 L335,346"/>
  </g>
  <g id="outputs">
    <circle class="node" cx="65" cy="350" r="4"/>
    <circle class="node" cx="95" cy="350" r="4"/>
    <circle class="node" cx="145" cy="350" r="4"/>
    <circle class="node" cx="175" cy="350" r="4"/>
    <circle class="node" cx="225" cy="350" r="4"/>
    <circle class="node" cx="255" cy="350" r="4"/>
    <circle class="node" cx="305" cy="350" r="4"/>
    <circle class="node" cx="335" cy="350" r="4"/>
  </g>
  <g id="port-labels">
    <text class="label" x="65" y="30" text-anchor="middle">0</text>
    <text class="label" x="65" y="368" text-anchor="middle">0</text>
    <text class="label" x="95" y="30" text-anchor="middle">1</text>
    <text class="label" x="95" y="368" text-anchor="middle">1</text>
    <text class="label" x="145" y="30" text-anchor="middle">2</text>
    <text class="label" x="145" y="368" text-anchor="middle">2</text>
    <text class="label" x="175" y="30" text-anchor="middle">3</text>
    <text class="label" x="175" y="368" text-anchor="middle">3</text>
    <text class="label" x="225" y="30" text-anchor="middle">4</text>
    <text class="label" x="225" y="368" text-anchor="middle">4</text>
    <text class="label" x="255" y="30" text-anchor="middle">5</text>
    <text class="label" x="255" y="368" text-anchor="middle">5</text>
    <text class="label" x="305" y="30" text-anchor="middle">6</text>
    <text class="label" x="305" y="368" text-anchor="middle">6</text>
    <text class="label" x="335" y="30" text-anchor="middle">7</text>
    <text class="label" x="335" y="368" text-anchor="middle">7</text>
  </g>
</svg>